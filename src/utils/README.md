# Утилиты (Utils)

В этой директории содержатся вспомогательные функции и утилиты для работы приложения.

## imageCompressor.js

Основной модуль для сжатия изображений и создания архивов:

### Функциональность
- Обработка различных форматов изображений (JPG, PNG, WebP, HEIC, и др.)
- Оптимальное сжатие с сохранением качества
- Ограничение максимальной ширины изображения до 1680 пикселей
- Расчет процента сжатия и экономии размера
- Обработка очереди изображений
- Возможность отслеживания прогресса обработки
- Создание ZIP-архива при обработке нескольких файлов
- Автоматическое скачивание результатов

### Техническая реализация
- Использует библиотеку browser-image-compression для сжатия
- Применяет Web Workers для предотвращения блокировки UI при обработке
- Настраивает уровень сжатия в зависимости от формата изображения
- Преобразует нестандартные форматы (HEIC, RAW) в поддерживаемые форматы перед сжатием
- Реализует Promise-based API для асинхронной обработки
- Включает обработку ошибок и отчеты о прогрессе
- Использует JSZip для архивации нескольких изображений
- Именует архивы по текущей дате и времени

### Основные функции:

#### compressImage(file, options)
Сжимает отдельное изображение с заданными параметрами.

Параметры:
- file: File - исходный файл изображения
- options: Object - настройки сжатия
  - maxSizeMB: Number - максимальный размер в МБ
  - onProgress: Function - колбэк для отслеживания прогресса
  - preserveExif: Boolean - сохранять ли метаданные EXIF

Возвращает: Promise<{file, originalSize, compressedSize, compressedFile}>

#### processQueue(files, options)
Обрабатывает очередь изображений последовательно и создает архив при необходимости.

Параметры:
- files: Array<File> - массив файлов для обработки
- options: Object - настройки обработки с колбэками
  - onFileProgress: Function - обновление прогресса для каждого файла
  - onFileComplete: Function - обработка завершения сжатия файла
  - onFileError: Function - обработка ошибок при обработке файла

Поведение:
- Если обрабатывается один файл, он скачивается напрямую
- Если обрабатывается несколько файлов, создается архив и скачивается

#### createZipArchive(files)
Создает ZIP-архив из массива файлов.

Параметры:
- files: Array<File> - массив файлов для добавления в архив

Возвращает: Promise<Blob> - Blob с архивом

#### formatFileSize(bytes)
Форматирует размер файла в человекочитаемый вид.

Параметры:
- bytes: Number - размер в байтах

Возвращает: String - форматированный размер (например, "1.5 MB") 